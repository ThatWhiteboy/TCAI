[Previous content of optimizer.ts with error handling and recovery]